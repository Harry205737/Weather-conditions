<title>W</title><b>WX</b><br><input id=A size=2><input id=B size=2><button onclick=g()>Go</button><button onclick=n()>GPS</button><p id=M style=margin:2px></p><div id=H style=font-size:10px></div><pre id=O style=font-size:10px;margin:0></pre><div style=font-size:9px;color:#666>0:SKC 1:FEW 3:OVC 45:FG 51:DZ 61:-RA 63:RA 71:SN 95:TS</div><script>
L=localStorage;A.value=L.a||'';B.value=L.b||'';
R=(j,u,k)=>{
  M.innerText=(u?'OK|':'Last|')+Math.round(j.current.apparent_temperature)+'° '+(u||L.u||'');
  H.innerHTML='';h=new Date().getHours();
  j.hourly.time.slice(h,h+24).map((t,i)=>{k=h+i;H.innerHTML+=`<b>${t.slice(11,13)}</b>:${Math.round(j.hourly.temperature_2m[k])}°/${j.hourly.precipitation[k]}m@${j.hourly.precipitation_probability[k]}% `});
  O.innerText='D  WX HI/LO R@%  KPH\n';
  j.daily.time.map((d,i)=>O.innerText+=`${d.slice(8,10)} C${j.daily.weathercode[i]} ${Math.round(j.daily.temperature_2m_max[i])}/${Math.round(j.daily.temperature_2m_min[i])} ${j.daily.precipitation_sum[i]}@${j.daily.precipitation_probability_max[i]}% ${Math.round(j.daily.windspeed_10m_max[i])}\n`)
};
if(L.j)R(JSON.parse(L.j),0);
n=()=>navigator.geolocation.getCurrentPosition(p=>{A.value=p.coords.latitude.toFixed(2);B.value=p.coords.longitude.toFixed(2);g()},()=>M.innerText='X');
g=async()=>{L.a=x=A.value;L.b=y=B.value;M.innerText='...';try{
  j=await(await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${x}&longitude=${y}&current=apparent_temperature&hourly=temperature_2m,precipitation,precipitation_probability&daily=weathercode,temperature_2m_max,temperature_2m_min,precipitation_sum,precipitation_probability_max,windspeed_10m_max&timezone=auto&forecast_days=3`)).json();
  L.u=u=new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});L.j=JSON.stringify(j);R(j,u)
}catch(e){M.innerText='Err'}};
</script>
