<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Victoria Conditions</title>
<style>
body {
  font-family: -apple-system, system-ui, sans-serif;
  background: #111;
  color: #fff;
  margin: 0;
  padding: 15px;
}
h1 { font-size: 20px; margin-bottom: 10px; }
.section {
  margin-bottom: 20px;
  padding: 10px;
  background: #1c1c1c;
  border-radius: 6px;
}
.alert { color: #ff4d4d; font-weight: bold; }
.ok { color: #4caf50; }
small { color: #aaa; }
</style>
</head>
<body>

<h1>Victoria Conditions</h1>

<div class="section">
  <h2>Fire Danger Rating</h2>
  <div id="fire">Loading...</div>
</div>

<div class="section">
  <h2>Warnings</h2>
  <div id="warnings">Loading...</div>
</div>

<div class="section">
  <h2>Weather (Current)</h2>
  <div id="weather">Loading...</div>
</div>

<script>

// ===== FIRE DANGER (CFA DATA) =====
fetch("https://data.emergency.vic.gov.au/public/incident.json")
  .then(res => res.json())
  .then(data => {
    const today = data.totalFDR;
    document.getElementById("fire").innerHTML =
      today ? `<strong>${today.rating}</strong>` : "Unavailable";
  })
  .catch(() => {
    document.getElementById("fire").innerText = "Offline";
  });

// ===== WARNINGS (VicEmergency Feed) =====
fetch("https://data.emergency.vic.gov.au/public/events-geojson.json")
  .then(res => res.json())
  .then(data => {
    const active = data.features
      .filter(f => f.properties.category1 === "Emergency Warning")
      .slice(0,3);

    if (active.length === 0) {
      document.getElementById("warnings").innerHTML =
        "<span class='ok'>No Emergency Warnings</span>";
    } else {
      document.getElementById("warnings").innerHTML =
        active.map(f =>
          `<div class='alert'>${f.properties.incidentName}</div>`
        ).join("");
    }
  })
  .catch(() => {
    document.getElementById("warnings").innerText = "Offline";
  });

// ===== WEATHER (BOM Lightweight Station Example) =====
// Replace station ID with your nearest BOM station
fetch("https://api.weather.bom.gov.au/v1/locations/melbourne/observations")
  .then(res => res.json())
  .then(data => {
    const obs = data.data;
    document.getElementById("weather").innerHTML =
      `${obs.temp}Â°C<br>Wind: ${obs.wind.speed_kilometre} km/h`;
  })
  .catch(() => {
    document.getElementById("weather").innerText = "Offline";
  });

// Auto refresh every 10 minutes
setTimeout(() => location.reload(), 600000);

</script>

</body>
</html>
