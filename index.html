<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Victoria Conditions</title>
</head>
<body>

<h1>Victoria Conditions</h1>

<h2>Fire Danger & Emergency Warnings</h2>
<div id="warnings">Loading warnings...</div>

<h2>Current Weather</h2>
<div id="weather">Loading weather...</div>

<script>

// ==========================
// CHANGE THESE TO YOUR AREA
// ==========================

// Example: Melbourne coordinates
// Replace with your usual bush coordinates
const latitude = -37.8136;
const longitude = 144.9631;


// ==========================
// WEATHER (Open-Meteo)
// ==========================
fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current_weather=true`)
  .then(response => response.json())
  .then(data => {
    const w = data.current_weather;
    document.getElementById("weather").innerHTML =
      "Temp: " + w.temperature + "°C<br>" +
      "Wind: " + w.windspeed + " km/h<br>" +
      "Wind Dir: " + w.winddirection + "°";
  })
  .catch(() => {
    document.getElementById("weather").innerText = "Weather unavailable";
  });


// ==========================
// VIC EMERGENCY WARNINGS
// ==========================
fetch("https://data.emergency.vic.gov.au/public/events-geojson.json")
  .then(response => response.json())
  .then(data => {

    const active = data.features
      .filter(f =>
        f.properties.category1 === "Emergency Warning" ||
        f.properties.category1 === "Watch and Act"
      )
      .slice(0,5);

    if (active.length === 0) {
      document.getElementById("warnings").innerText = "No Emergency or Watch & Act warnings.";
    } else {
      document.getElementById("warnings").innerHTML =
        active.map(f =>
          "<strong>" + f.properties.category1 + "</strong>: " +
          f.properties.incidentName + "<br>"
        ).join("");
    }
  })
  .catch(() => {
    document.getElementById("warnings").innerText = "Warnings unavailable";
  });


// ==========================
// Auto refresh every 10 mins
// ==========================
setTimeout(() => location.reload(), 600000);

</script>

</body>
</html>
