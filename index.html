<title>W</title><b>WX</b><br><input id=A placeholder=Lt size=3><input id=B placeholder=Lo size=3><button onclick=g()>Go</button><button onclick=n()>GPS</button><p id=M style=margin:2px></p><div id=H style=font-size:10px></div><table border=1 style=border-collapse:collapse;font-size:10px id=O></table><script>L=localStorage;A.value=L.a||'';B.value=L.b||'';W=c=>({0:'SKC',1:'FEW',2:'SCT',3:'OVC',45:'FG',51:'DZ',61:'-RA',63:'RA',65:'+RA',71:'SN',95:'TS'}[c]||'C'+c);n=()=>(M.innerText='...',navigator.geolocation.getCurrentPosition(p=>{A.value=p.coords.latitude.toFixed(2);B.value=p.coords.longitude.toFixed(2);g()},()=>M.innerText='X'));g=async()=>{x=A.value;y=B.value;L.a=x;L.b=y;M.innerText='...';try{r=await(await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${x}&longitude=${y}&current=apparent_temperature&hourly=temperature_2m,precipitation,precipitation_probability&daily=weathercode,temperature_2m_max,temperature_2m_min,precipitation_sum,precipitation_probability_max,windspeed_10m_max&timezone=auto&forecast_days=3`)).json();M.innerText=`OK|${Math.round(r.current.apparent_temperature)}°`;O.innerHTML='<tr><th>D<th>W<th>T<th>P<th>K';H.innerHTML='';t=new Date().getHours();r.hourly.time.slice(t,t+24).map((_,i)=>{k=t+i;H.innerHTML+=`${r.hourly.time[k].slice(11,13)}h:${Math.round(r.hourly.temperature_2m[k])}° `});r.daily.time.map((d,i)=>{O.insertRow().innerHTML=`<td>${d.slice(8,10)}<td>${W(r.daily.weathercode[i])}<td>${Math.round(r.daily.temperature_2m_max[i])}/${Math.round(r.daily.temperature_2m_min[i])}<td>${r.daily.precipitation_sum[i]}@${r.daily.precipitation_probability_max[i]}%<td>${Math.round(r.daily.windspeed_10m_max[i])}`})}catch(e){M.innerText='Err'}}</script>
